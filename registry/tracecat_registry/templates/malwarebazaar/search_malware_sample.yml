title: action
definition:
  title: Search Malware Sample with MalwareBazaar
  description: Get threat intel report for a malware sample from MalwareBazaar.
  display_group: MalwareBazaar
  namespace: integrations.malwarebazaar
  name: search_malware_sample
  secrets:
    - name: malwarebazaar
      keys: ["MALWAREBAZAAR_API_KEY"]
  expects:
    file_hash:
      type: str
      description: The hash of the malware sample to search.
  steps:
    - ref: search_malware_sample
      action: core.http_request
      args:
        url: https://mb-api.abuse.ch/api/v1/
        method: POST
        headers:
          API-KEY: ${{ SECRETS.malwarebazaar.MALWAREBAZAAR_API_KEY }}
        payload:
          query: get_info
          hash: ${{ inputs.file_hash }}
  returns: ${{ steps.search_malware_sample.result }}
