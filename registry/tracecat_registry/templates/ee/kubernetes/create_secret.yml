type: action
definition:
  title: Create generic secret
  description: Create a secret in a Kubernetes cluster.
  namespace: tools.kubernetes
  name: create_secret
  expects:
    name:
      type: str
      description: Name of the secret to create.
    namespace:
      type: str
      description: Namespace to create the secret in.
    data:
      type: dict[str, str]
      description: Key-value pairs to insert into the secret.
  steps:
    - ref: secret_literals
      action: core.transform.apply
      args:
        value: ${{ inputs.data }}
        python_lambda: >
          lambda x: " ".join(f"--from-literal {k}={v}" for k, v in x.items())
    - ref: create_secret
      action: ee.kubectl.run_command
      args:
        command:
          - create
          - secret
          - generic
          - ${{ inputs.name }}
          - ${{ steps.secret_literals.result }}
        namespace: ${{ inputs.namespace }}
  returns: ${{ steps.create_secret.result }}
