type: action
definition:
  title: Get report summary
  description: Retrieve a Hybrid Analysis report summary by report ID.
  display_group: Hybrid Analysis
  doc_url: https://hybrid-analysis.com/docs/api/v2#/Report/get_report__report_id__summary
  namespace: tools.hybrid_analysis
  name: get_report_summary
  secrets:
    - name: hybrid_analysis
      keys:
        - HYBRID_ANALYSIS_API_KEY
  expects:
    report_id:
      type: str
      description: Hybrid Analysis report identifier (e.g. SHA256 or submission ID).
  steps:
    - ref: get_summary
      action: core.http_request
      args:
        url: https://www.hybrid-analysis.com/api/v2/report/${{ FN.url_encode(inputs.report_id) }}/summary
        method: GET
        headers:
          accept: application/json
          api-key: ${{ SECRETS.hybrid_analysis.HYBRID_ANALYSIS_API_KEY }}
          user-agent: Tracecat
  returns: ${{ steps.get_summary.result.data }}
