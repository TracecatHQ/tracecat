type: action
definition:
  title: Isolate SentinelOne Agents
  description: Disconnects SentinelOne agents from the network by IDs
  display_group: SentinelOne
  namespace: integrations.sentinel_one
  action: integrations.sentinel_one.isolate_agents
  expects:
    agent_ids:
      type: list[str]
      description: The IDs of the agents to isolate
  layers:
    - ref: isolate_agents
      action: core.http_request
      args:
        url: ${{ SECRETS.sentinel_one.SENTINEL_ONE_BASE_URL }}/web/api/v2.1/agents/actions/disconnect
        method: POST
        headers:
          Authorization: ${{ SECRETS.sentinel_one.SENTINEL_ONE_API_TOKEN }}
          Content-Type: application/json
        payload:
          filter:
            ids: ${{ inputs.agent_ids }}
  returns: ${{ layers.isolate_agents.result }}
